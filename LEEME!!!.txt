================================================================================
TAREAS PENDIENTES - peruHCE
================================================================================

PROBLEMAS CRITICOS
==================

1. Legacy UI - Bug Activo
   - Estado: Bug identificado en la interfaz legacy 1.23.0
   - Accion requerida: Workaround y luego upgradear la version

2. Dependencias en Versiones SNAPSHOT (NO ESTABLES)
   - Modulos afectados:
     * fua - Actualmente deberia estar en version SNAPSHOT (no estable)
     * vaccination - Actualmente en version SNAPSHOT (no estable)
   - Accion requerida: Terminar de desarrollar a versiones estables (release) para produccion
   - Prioridad: ALTA

3. Despliegue SSL
   - Problema RESUELTO: La redireccion forzada HTTP->HTTPS se activaba por la variable
     CERT_WEB_DOMAIN_COMMON_NAME en el archivo .env
   - Solucion: Para desarrollo sin SSL, comentar la linea:
     # CERT_WEB_DOMAIN_COMMON_NAME=hii1sc-dev.inf.pucp.edu.pe
   - Como funciona:
     * Si CERT_WEB_DOMAIN_COMMON_NAME esta definida -> Activa modo SSL (redirecciona)
     * Si NO esta definida -> Modo HTTP puro (sin redireccion)
     * El script gateway/docker-entrypoint.sh decide que configuracion nginx usar
   - Para produccion: DESPLEGAR SIEMPRE CON SSL HABILITADO

   - Procedimiento para desarrollo sin SSL:
     1. Comentar CERT_WEB_DOMAIN_COMMON_NAME en .env
     2. Reconstruir gateway:
        docker compose build --no-cache gateway
     3. Copiar archivos de configuracion al frontend (WORKAROUND RAPIDO):
        docker cp frontend/config/config-openmrs.json peruHCE-frontend:/usr/share/nginx/html/
        docker cp frontend/config/config-pucp.json peruHCE-frontend:/usr/share/nginx/html/
     4. Recrear gateway:
        docker compose up -d gateway

   - Procedimiento completo (reconstruir todo desde cero):
     1. Comentar CERT_WEB_DOMAIN_COMMON_NAME en .env
     2. Reconstruir frontend y gateway:
        docker compose build --no-cache frontend gateway
     3. Remover volumenes viejos:
        docker volume rm peruhce-distro-referenceapplication_openmrs-frontend
     4. Recrear contenedores:
        docker compose up -d frontend gateway

   - Problema adicional: Archivos config-openmrs.json y config-pucp.json
     * El frontend necesita estos archivos para funcionar (404 si no existen)
     * Estan en frontend/config/ y se copian en el Dockerfile
     * El volumen openmrs-frontend puede tener contenido viejo sin estos archivos
     * Solucion rapida: Copiar manualmente con docker cp (ver paso 3 arriba)
     * Solucion permanente: Reconstruir sin cache y eliminar volumen


INFRAESTRUCTURA Y DEVOPS
=========================

Backups
-------
   - Estado: Esquema de backup NO esta maduro
   - Opciones a considerar:
     * Implementar solucion basada en Ozone
     * Integrar la propuesta actual amo-esclavo de Marcelo
     * Configurar copias a Ozono
   - Prioridad: ALTA

Monitoring
----------
   - Estado: Implementado pero PENDIENTE DE MEJORAS
   - Accion: Definir metricas adicionales y alertas


DESARROLLO Y ACTUALIZACION DE MODULOS
======================================

Microfrontends Fase 1
---------------------
   - Estado: Pendiente de subir/actualizar
   - Microfrontend nuevos:
     * Login mejorado (agregar roles y permisos)
     * Validar microfrontends de imagenes medicas (Referencias: Basarse en el trabajo de Zhao)
   - Nota: Posible incompatibilidad con nuevas versiones de OMODs que dan soporte (FALTA TESTEAR)

OMODs Fase 2 (hospitalizacion, facturacion, etc)
------------
   - Estado: Pendiente de actualizar versiones
   - Accion: Subir versiones actualizadas

FUA Generator
-------------
   - Estado: VALIDAR ESTADO DE ESTE COMPONENTE
   - Accion: Revision completa del componente


SEGURIDAD Y AUTENTICACION
==========================

Keycloak
--------
   - Estado: Pendiente de implementacion (DEUDA TECNICA)
   - Referencias: Basarse en configuracion de Ozone
   - Accion: Configurar integracion completa

RefCom Integration
------------------
   - Estado: Pendiente de implementacion
   - Complejidad: MEDIA-ALTA
   - Requiere: Desarrollo de un OMOD que actue como middleware
   - Descripcion: NO es solo configuracion CORS, necesita integracion mediante modulo
   - Accion: Desarrollar OMOD middleware para comunicacion con RefCom
   - Prioridad: MEDIA

Firma Digital y SETISIS
------------------------
   - Estado: Pendiente de implementacion
   - Componentes:
     * Integracion con SETISIS
     * Sistema de firma digital


FRONTEND
========

Mejoras Pendientes:
   [ ] Actualizar componente de login
   [ ] Implementar sistema de roles y permisos
   [ ] Validar compatibilidad de imagenes


ROADMAP Y PROXIMOS PASOS
=========================

1. INMEDIATO
   - Estabilizar dependencias (migrar de SNAPSHOT a versiones release)

2. CORTO PLAZO
   - Implementar esquema de backups robusto
   - Mejorar sistema de monitoring

3. MEDIO PLAZO
   - Integrar Keycloak
   - Actualizar microfrontends (Fase 1)
   - Actualizar OMODs (Fase 2)
   - Desarrollar OMOD middleware para RefCom

4. LARGO PLAZO
   - Completar integraciones SETISIS
   - Implementar firma digital
   - Validar y estabilizar FUA Generator


NOTAS IMPORTANTES
=================

- Este documento debe actualizarse conforme se completen las tareas
- Priorizar la estabilizacion de versiones SNAPSHOT antes de produccion
- Mantener documentacion actualizada del README principal
- Testear exhaustivamente la compatibilidad de imagenes

================================================================================
Ultima actualizacion: 2025-11-05
================================================================================
